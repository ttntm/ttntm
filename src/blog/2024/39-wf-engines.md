---
title: Thoughts About Workflow Engines
slug: thoughts-about-workflow-engines
date: 2024-01-25
description: A collection of thoughts about aligning software development with workflow engines.
tags:
  - learning
  - opinion
image: /img/blog/workflow.jpg
---

A couple of months ago, I started working on a project with the desired outcome of building a large and complex application including a 3rd party workflow engine. A wild mixture of a planned microservice and orchestration (-driven) architecture was written into the requirements documents supplied by the customer, making the whole thing sound a lot like "I want to draw software..." when read between the lines.

I spent a lot of time with the topic since then: lots of discussions and workshops, and I'm also building an ever-growing proof of concept application. One thing I can already say with a bit of confidence is, that in doing so, I'm definitely learning a lot. Consequently, this article is a collection of thoughts about aligning software development and workflow engines.

<img src="/img/blog/workflow.jpg" class="img-fluid img-center" alt="An illustration of workflow from Undraw">

## What's a Workflow Engine?

I guess it's always good to start with a definition. I'm feeling a bit lazy though, so this definition was generated by {% ext "perplexity", "https://www.perplexity.ai" %}. The LLM claims that the following definition is based on Wikipedia, IBM and a couple of other sources:

> A workflow engine is a software application that manages and automates business processes. It typically uses a database server and pre-coded scripts to manage and maintain workflows. The workflow engine manages and monitors the state of activities in a workflow and determines which new activity to transition to according to defined processes. It can execute any arbitrary sequence of steps and facilitates the flow of information, tasks, and events. Workflow engines have utility in numerous industries and applications, from connecting remote workers to approving vacation to invoicing. They can automate routine tasks and procedures in a business environment, allowing employees to focus on more important work. By automating processes, businesses can ensure that tasks are completed accurately, promptly, and efficiently, which improves the overall customer experience, increases customer loyalty, and reduces costs.
>
> <small>{% ext "perplexity", "https://www.perplexity.ai/search/what-is-a-YC8We2kkQjaxg_mx65CfHg?s=c#602f167b-6924-4236-b183-f9b1eb909f1e" %}</small>

I didn't edit that response because I would say that I mostly agree with it. It's neither too detailed, nor too sales-y for the purpose of this article. Let's have a closer look at it:

> A software application that manages and automates business processes

On the surface: kind of yes.

But: I learned that the "business" in any given business process does not necessarily have to be the right level of detail for an _executable_ workflow. There might be a lot of options in specific BPM notations (i.e. {% ext "BPMN", "https://www.bpmn.org/" %}), but it's up to the respective engine to define which specific decisions, events, tasks, etc. of any given notation it actually supports.

> The workflow engine manages and monitors the state of activities in a workflow and determines which new activity to transition to

Yes, I agree with that statement.

> It can execute any arbitrary sequence of steps and facilitates the flow of information, tasks, and events.

Mostly yes, but if we define that _facilitate_ == "to make easy or easier", then we absolutely have to talk about _added_ complexity due to the use of a workflow engine. I'll get back to that one in a bit.

> Workflow engines have utility in numerous industries and applications, from connecting remote workers to approving vacation to invoicing.

Yeah, why not.

NB: approving a thing, invoicing and order processing are very common examples. They can often be thought of as highly automated processes, which works in favor of workflow engines. That's probably why these use cases are very popular in both vendor documentation and marketing.

> They can automate routine tasks and procedures in a business environment, allowing employees to focus on more important work.

They absolutely can, yes.

But: it gets tricky when they're utilized to automate tasks and procedures that are _not_ routine. And once there is a license for a workflow engine available, that's inevitably going to come up.

> Businesses can ensure that tasks are completed accurately, promptly, and efficiently, which improves the overall customer experience, increases customer loyalty, and reduces costs.

Well, I guess it's definitely possible that some or even all of that can happen, but I think the LLM went a little overboard here. The statement doesn't add anything to the definition, and it rather sounds like some marketing site gibberish that you'd expect to find somewhere near a CTA.

With the definition taken care of, we can now move on and explore a couple of topics that will sooner or later come up when you're dealing with workflow engines.

## The Low-Code Promise

In theory, making use a workflow engine sounds like an easy way out of having to develop custom applications or to request changes from software vendors and solution providers. I decided to call this "the low-code promise", considering that many business user expectations often revolve around making increasingly complex software functionality easy to change (i.e. changing a process flowchart). I wouldn't go so far as to call this an _empty promise_, but I'd definitely argue that it is a common pitfall in terms of misaligned expectations. It wouldn't come as a surprise to notice that this is suitable leverage for many software vendors' marketing and sales efforts...

What's likely to cause these misaligned expectations is probably a mixture of both, a lack of technical understanding and the lack of awareness/information regarding the larger landscape of systems and applications a workflow engine gets placed in. Yes, of course, there are interfaces for commonly used communication protocols, systems and applications, but most - if not all - of them expect to be consumed/used in a certain way and won't be able to support the flexibility that "drawing software" based on flowcharts profusely implies.

So, what a workflow engine ends up being used as eventually, can probably best be described as an _orchestrator_ of functionality that is actually handled by dedicated services, systems and applications. As such, lots of - potential - flexibility gets lost due to constraints of APIs, interfaces, concurrency and the necessary sequence of the actual data processing. Workflow-based orchestration might be a benefit for some use cases (i.e. avoiding hard-coded cron jobs, working with legacy systems), but it also causes an increased overhead in terms of having to maintain the necessary artifacts (i.e. flowcharts) and code (i.e. job workers, interfaces) the workflow engine needs.

## Workflow-Driven Architecture

Let's think of a monolithic MVC application with 3 layers like this:

```txt
[   Front end (web) client      ]
*-------------------------------*
[   Back end (business) logic   ]
*-------------------------------*
[   Database/s                  ]
```

In comparison, an application that's ready for process-driven orchestration could look like this:

```txt
[   Front end (web) client      ]
*-------------------------------*
[   BFF (or API gateway)        ]
*-------------------------------*
[   Workflow engine             ]
*-------------------------------*
[   Back end (business) logic   ]
*-------------------------------*
[   Database/s                  ]
```

An architecture like this becomes necessary when a workflow engine is defined as the main driver of "the flow of information, tasks, and events" (as per the definition above). Thinking of case management in customer service, a somewhat realistic example could end up looking like this:

1. A web-to-case form on a public website triggers the creation of a new case in a customer service application (CSA)
2. A new workflow instance matching this business process starts; this can happen based on a message subscription or an API call for example; either way, the CSA backend has to send an event that includes the new case's ID
3. As a first step, the workflow performs a lookup into the CSA database to obtain all case data; there is a standard API for this lookup, but the URL and some credentials have to be made available for the workflow instance
4. Next, the workflow processes a business rule task to determine where the new case should be routed; this could happen based on case data (i.e. a "topic" the reporter had to select when opening the case), but it could also make another API call to the CSA or another system (i.e. employee availabilities) necessary
5. The new case gets assigned to an employee by the workflow engine; an API call to the CSA backend happens and the necessary fields on the case record get updated; via its BFF, the front end is now able to show the case in the assigned employees' "my cases" view
6. The workflow engine proceeds to a wait step and is actively listening to messages with a matching correlation ID (i.e. the case ID) at the same time; firing that event is based on the UI and thus a responsibility of the BFF
    1. Nothing happens, a timer set in the workflow expires: the workflow engine triggers an email notification and circles back to the previous step (wait for event/timeout); that's another API call to the CSA backend (or another system)
    2. The case status changes, the BFF fires the respective event:
        1. Case completed (any resolution): the workflow engine completes the task via an API call to the CSA backend, the workflow instance for this task ends
        2. Case review requested: the workflow engine starts a new instance of the case review sub-process; the parent process stays at this step until the sub-process instance gets completed; whenever that happens, the workflow circles back to a previous step (wait for event/timeout)

I hope that this example is detailed enough to illustrate the _added_ complexity that adopting workflow-driven architecture can cause.

As mentioned earlier, I don't think that developing software the way it would be necessary to enable such architecture makes anything easier at all (re: "facilitates..." from the definition above). I'm saying that specifically due to the following aspects:

- (Additional) glue code is absolutely necessary to enable the communication between workflow steps and the logic necessary to perform the actual work a task in a workflow represents; this overhead can be reduced slightly by a workflow engine's own libraries for example, but the issue of redundancy and code duplication persists regardless of that
- Instead of talking to their own backend/database directly, applications can have to go through the workflow engine (or at least offer the possibility of doing so), which can make such functionality more complex and much less transparent
- Applications, services and systems have to expose additional interfaces to trigger functionality that would normally be handled by the resource itself, which can further increase complexity and complicate engineering and maintenance efforts
- Applications, services and systems have to account for workflow steps happening out of (the intended) sequence (control flow), or at least be able to handle the possibility of this happening at some point, which can lead to redundancy and code duplication
- Logic that is usually handled by an application itself (i.e. task > employee assignment in the example above) is taken out of context and processed elsewhere; this perceived "flexibility" can easily turn into a maintenance nightmare

I'm probably missing something, but that's a lot already anyway. And what's probably the best conclusion for this section, is this 2nd hand quote from an older {% ext "Martin Fowler article on software architecture", "https://martinfowler.com/ieeeSoftware/whoNeedsArchitect.pdf" %} that I think fits very well here:

> There is no theoretical reason that anything is hard to change about software. If you pick any one aspect of software then you can make it easy to change, but we don't know how to make everything easy to change. Making something easy to change makes the overall system a little more complex, and making everything easy to change makes the entire system very complex. Complexity is what makes software hard to change. That, and duplication.
>
> <small>Ralph E. Johnson</small>

## Possible Benefits

Workflow engines are a rather popular type of - enterprise - software, so it can't all be bad, right? ...right?

So, yes, of course, there are benefits of using workflow engines:

- They usually work rather well in event-driven architectures in terms of detecting, consuming and reacting to messages in (near-) real-time, which can start/continue/interrupt/... workflow instances
- They can also help when you're forced to include legacy applications and services in larger, more modern systems because the legacy application's specific requirements (i.e. in terms of interfaces) can be taken care of using the workflow engine's functionality
- They can actually fulfill the "low-code promise" mentioned above if (and when) new and existing applications, services and systems support it well enough
- They offer "documentation as a side effect" in terms of providing - more or less - usable process flowcharts for interfaces and functionality that would otherwise just be (insufficiently documented...) code

## Closing Thoughts

What I had in mind when I decided to write this article and started planning it, was that I wanted to avoid ranting. I can only hope that I managed to live up to my own intention and deliver a somewhat diversified collections of thoughts on the topic.

Like I said in the beginning of this article, I'm still learning a lot about aligning software development with a workflow engine at the moment, so I don't think I can offer any kind of definitive conclusion at this time. Generally, workflow engines are very complex and powerful pieces of software, and I have a lot of respect for the teams of engineers that work on such products.

And as it is the case with many decisions, the decision of whether a workflow engine offers benefits that outweigh the cost of adopting one is definitely a lengthy process that every team and company that's thinking about it will have to find their own answer to.
